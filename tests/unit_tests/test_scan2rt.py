from petasus.scripts import scan2rt
import pandas as pd


def test_scan2rt():
    scan2rt_test = scan2rt.parse_mzml("../data/small_220709_E5.mzML")

    scan2rt_manual_map = [
        (40487, 30.021875036176),
        (40501, 30.032939637121),
        (40543, 30.063650254822),
        (40550, 30.067957938131),
        (40600, 30.106231685893),
        (40647, 30.139757486598),
        (40648, 30.140372936344),
        (40661, 30.150824038601),
        (40695, 30.174185518837),
        (40728, 30.199368318335),
        (40731, 30.201213618533),
        (40733, 30.202444084899),
        (40763, 30.223329635874),
        (40773, 30.232581619835),
        (40871, 30.305003321584),
        (40879, 30.309923955218),
        (40888, 30.315457769648),
        (40905, 30.328380736128),
        (40938, 30.35343888642),
        (41042, 30.429572336292),
        (41046, 30.43203322134),
        (41066, 30.4467656696),
        (41085, 30.460895069853),
        (41375, 30.673435938772),
        (41393, 30.684494169966),
        (41397, 30.689270651754),
        (41444, 30.723093235906),
        (41493, 30.758156987445),
        (41745, 30.942647453562),
        (41754, 30.950639601962),
    ]

    scan2rt_manual = pd.DataFrame(scan2rt_manual_map, columns=["scan", "rt"])

    pd.testing.assert_frame_equal(scan2rt_test.to_pandas(), scan2rt_manual)
